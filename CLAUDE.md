# Atlas PIM - Product Information Management System

*Generated by thoughtful-dev - Last updated: 2025-10-28 09:30*

## Quick Context

Atlas PIM is a headless CMS for product data management with automated Promidata supplier integration. Built on Strapi v5.17.0 with PostgreSQL (Neon), it manages 7 content types across 1000+ products with multilingual support, automated image sync to Cloudflare R2, and RESTful APIs for frontend consumption.

## Essential Commands

```bash
# Backend (Strapi CMS)
cd backend
npm install                    # Install dependencies
npm run develop                # Development server (http://0.0.0.0:7337)
npm run build                  # Build production bundle
npm start                      # Production server

# Frontend (Static Build)
cd frontend/dist
npx serve -p 3000             # Serve static files (http://localhost:3000)

# Testing & Utilities
node backend/scripts/test-promidata-sync.js           # Test Promidata API
node backend/scripts/enable-public-permissions.js    # Enable public API access
node backend/scripts/import-malfini.js               # Import specific supplier

# Docker Deployment
./dc.sh up                    # Start all services
docker-compose -f docker-compose-promovere-pim.yml up -d
```

## Core Principles

### MANDATORY Rules

- **NEVER commit `.env` files** - Contains production secrets (DB credentials, API keys, R2 access)
- **ALWAYS work on feature branches** - Never push directly to `main` or `test_atlas`
- **Backend changes require restart** - `npm run develop` auto-reloads, but sometimes manual restart needed
- **Public API permissions are auto-enabled** - Bootstrap sets this up in `backend/src/index.ts`
- **Respect Neon connection limits** - Pool limited to 1 connection (DATABASE_POOL_MAX=1)
- **Images follow naming convention** - `{sku}-primary.jpg`, `{sku}-1.jpg`, etc. in Cloudflare R2
- **Use promidata_hash for change detection** - Don't re-import unchanged products

### DO NOT

- Modify Promidata sync service without testing on staging suppliers first
- Change content type schemas without database migration
- Store files locally - all media goes to Cloudflare R2
- Query production database directly - use Strapi admin or APIs
- Hardcode supplier mappings - they're in the sync service (consider moving to DB)
- Skip multilingual fields - Products use JSON structure: `{ en: "value", nl: "value" }`

## Documentation Maintenance

Mode: ask

The `doc-maintenance` skill will remind you to update documentation after:
- Adding/removing dependencies in package.json
- Changing Strapi content type schemas
- Modifying Promidata sync logic
- Updating environment variables

Set to `auto` for automatic updates, or `ask` to be prompted (recommended).

Run `/thoughtful-dev:audit-docs` periodically to check for drift.

## Imported Documentation

When working on specific areas, these detailed docs are auto-loaded:

@.claude/INDEX.md - Documentation directory with descriptions
@.claude/STACK.md - Tech stack (Strapi, Neon, R2, Promidata)
@.claude/ARCHITECTURE.md - System design, content types, data model
@.claude/PATTERNS.md - Code conventions and Strapi patterns
@.claude/STARTUP.md - Environment setup and troubleshooting
@.claude/GOTCHAS.md - Known issues and workarounds
@.claude/DECISIONS.md - Architectural decision log

## Project URLs

- **Backend Admin**: http://0.0.0.0:7337/admin
- **Backend API**: http://0.0.0.0:7337/api
- **Frontend**: http://localhost:3000
- **Production**: https://atlas-strapi.solsdev.com

## Branch Information

**Current Branch**: `test_atlas` (main production backend)
- Focus: Strapi backend + static frontend
- Promidata integration + product management

**Alternative Branch**: `n8n_workflow` (full-stack with AI)
- Next.js frontend with AI chat
- n8n workflows, Qdrant vector DB, semantic search
- Switch: `git checkout n8n_workflow`
